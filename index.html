<!DOCTYPE html>
<html lang="mr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡§¨‡•ç‡§∞‡§π‡•ç‡§Æ‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ ‡§ï‡§≤‡•ç‡§™‡§¶‡•ç‡§∞‡•Ç‡§Æ</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#111111">
    
    <script src="https://cdn.jsdelivr.net/npm/fuse.js/dist/fuse.min.js"></script>

    <style>
        /* --- 1. ‡§µ‡•ç‡§π‡•á‡§∞‡§ø‡§è‡§¨‡§≤‡•ç‡§∏ ‡§Ü‡§£‡§ø ‡§•‡•Ä‡§Æ --- */
        :root {
            --bg-image-light: url('https://plus.unsplash.com/premium_photo-1671684686834-d72a16307e38?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&q=80&w=1227');
            --bg-image-dark: url('https://images.unsplash.com/photo-1657632843433-e6a8b7451ac6?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&q=80&w=1424');
            --glass-bg-light: rgba(255, 255, 255, 0.15);
            --glass-border-light: rgba(255, 255, 255, 0.2);
            --text-color: #ffffff;
            --glass-bg-dark: rgba(0, 0, 0, 0.15);
            --glass-border-dark: rgba(255, 255, 255, 0.1);
            --blur-amount: 15px;
            --highlight-color: #00bcd4; /* ‡§®‡§µ‡•Ä‡§® */
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            min-height: 100vh; padding: 1.5rem; color: var(--text-color);
            background-image: var(--bg-image-light);
            background-size: cover; background-position: center;
            background-attachment: fixed; transition: background-image 0.7s ease-in-out;
        }
        body[data-theme="dark"] { background-image: var(--bg-image-dark); }

        /* --- 2. ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§ï‡§Ç‡§ü‡•á‡§®‡§∞ --- */
        .container { max-width: 800px; margin: 0 auto; text-align: center; }
        header h1 { font-size: 2.2rem; margin-bottom: 1rem; text-shadow: 0 2px 5px rgba(0, 0, 0, 0.5); }
        .subtitle {
            font-size: 0.9rem; line-height: 1.6; padding: 1rem;
            margin: 0 auto 2rem auto; max-width: 600px; text-align: center;
            font-style: italic; opacity: 0.9;
        }

        /* --- 3. iOS ‡§∏‡§æ‡§∞‡§ñ‡§æ Glass UI --- */
        .glass-ui {
            background: var(--glass-bg-light);
            backdrop-filter: blur(var(--blur-amount));
            -webkit-backdrop-filter: blur(var(--blur-amount));
            border: 1px solid var(--glass-border-light);
            border-radius: 16px;
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
            transition: background 0.3s ease, border 0.3s ease;
        }
        body[data-theme="dark"] .glass-ui {
            background: var(--glass-bg-dark);
            border: 1px solid var(--glass-border-dark);
        }

        /* --- 4. ‡§°‡•á/‡§®‡§æ‡§à‡§ü ‡§ü‡•â‡§ó‡§≤ --- */
        .theme-switch-wrapper { display: flex; align-items: center; justify-content: center; margin-bottom: 1.5rem; }
        .theme-switch { display: inline-block; height: 34px; position: relative; width: 60px; }
        .theme-switch input { display: none; }
        .slider {
            background-color: #555; bottom: 0; cursor: pointer; left: 0;
            position: absolute; right: 0; top: 0; transition: .4s; border-radius: 34px;
        }
        .slider:before {
            content: 'üåô'; font-size: 18px; line-height: 26px; text-align: center;
            background-color: #fff; bottom: 4px; height: 26px; left: 4px;
            position: absolute; transition: .4s; width: 26px; border-radius: 50%;
        }
        input:checked + .slider { background-color: #ccc; }
        input:checked + .slider:before { content: '‚òÄÔ∏è'; transform: translateX(26px); }

        /* --- 5. ‡§µ‡•ç‡§π‡•ç‡§Ø‡•Ç ‡§ü‡•â‡§ó‡§≤ ‡§¨‡§ü‡§£‡•á --- */
        .view-toggle {
            display: flex; justify-content: center; padding: 0.5rem;
            margin: 0 auto 1.5rem auto; width: fit-content;
        }
        .view-toggle button {
            background: transparent; border: none; color: var(--text-color);
            font-size: 1.5rem; padding: 0.25rem 1rem; cursor: pointer;
            opacity: 0.5; transition: opacity 0.2s ease, transform 0.2s ease;
        }
        .view-toggle button.active { opacity: 1; transform: scale(1.1); }
        .view-toggle button:hover { opacity: 0.8; }

        /* --- 6. ‡§∏‡§∞‡•ç‡§ö ‡§¨‡§æ‡§∞ (‡§Ü‡§£‡§ø ‡§ï‡§Æ‡§æ‡§Ç‡§° ‡§™‡•Ö‡§≤‡•á‡§ü) --- */
        .search-wrapper { position: relative; }
        #search-bar {
            width: 100%; padding: 1rem; font-size: 1rem;
            border: none; outline: none; color: var(--text-color);
            margin-bottom: 1.5rem;
        }
        #search-bar::placeholder { color: rgba(255, 255, 255, 0.7); }
        /* ‡§®‡§µ‡•Ä‡§®: Cmd+K ‡§ü‡§ø‡§™ (Item 8) */
        .cmd-tip {
            position: absolute; right: 1rem; top: 0.9rem;
            font-size: 0.8rem; background: rgba(0,0,0,0.2);
            padding: 0.2rem 0.5rem; border-radius: 6px;
            pointer-events: none; opacity: 0.7;
        }

        /* --- 7. ‡§ï‡•Ö‡§ü‡•á‡§ó‡§∞‡•Ä ‡§Ü‡§£‡§ø ‡§∏‡•á‡§ï‡•ç‡§∂‡§®‡•ç‡§∏ --- */
        .category-section { margin-bottom: 2.5rem; text-align: left; }
        .category-title {
            font-size: 1.5rem; padding: 0.75rem 1.25rem;
            margin-bottom: 1.5rem; display: inline-block;
        }

        /* --- 8. ‡§ï‡•Ö‡§ü‡•á‡§ó‡§∞‡•Ä ‡§≤‡§ø‡§∏‡•ç‡§ü (‡§•‡§Ç‡§¨‡§®‡•á‡§≤‡§∏‡§π) --- */
        .category-list { list-style: none; }
        .category-list li {
            padding: 1.25rem;
            cursor: pointer;
            margin-bottom: 1.5rem;
            position: relative;
            background-size: cover; background-position: center;
            min-height: 150px;
            display: flex; flex-direction: column;
            justify-content: center; overflow: hidden;
            
            /* ‡§®‡§µ‡•Ä‡§®: 3D ‡§ü‡§ø‡§≤‡•ç‡§ü (Item 4) ‡§Ü‡§£‡§ø ‡•≤‡§®‡§ø‡§Æ‡•á‡§∂‡§® (Item 2) */
            transition: transform 0.3s ease, background 0.2s ease, box-shadow 0.3s ease;
            transform-style: preserve-3d;
        }
        /* 3D ‡§ü‡§ø‡§≤‡•ç‡§ü ‡§á‡§´‡•á‡§ï‡•ç‡§ü (Item 4) */
        .category-list li:hover {
            transform: scale(1.03) perspective(1000px) rotateX(2deg) rotateY(3deg);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        }
        
        .category-list li::before { /* ‡§•‡§Ç‡§¨‡§®‡•á‡§≤‡§µ‡§∞ ‡§ó‡§°‡§¶ ‡§≤‡•á‡§Ø‡§∞ */
            content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0, 0, 0, 0.5); z-index: 1; border-radius: 16px;
            transition: background 0.3s ease;
        }
        .category-list li:hover::before { background: rgba(0, 0, 0, 0.3); }
        
        /* ‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü‡§≤‡§æ ‡§≤‡•á‡§Ø‡§∞‡§ö‡•ç‡§Ø‡§æ ‡§µ‡§∞ ‡§Ü‡§£‡§£‡•ç‡§Ø‡§æ‡§∏‡§æ‡§†‡•Ä */
        .card-content { position: relative; z-index: 2; }
        .card-content h2, .card-content p {
            text-shadow: 0 1px 3px rgba(0,0,0,0.8);
        }
        .card-content h2 { font-size: 1.5rem; margin-bottom: 0.25rem; }
        .card-content p { font-size: 0.9rem; opacity: 0.9; }

        /* ‡§®‡§µ‡•Ä‡§®: ‡§ï‡§æ‡§∞‡•ç‡§°‡§µ‡§∞‡•Ä‡§≤ ‡§¨‡§ü‡§£‡•á (Item 13, 15) */
        .card-actions {
            position: absolute;
            z-index: 2;
            top: 0.75rem;
            right: 0.75rem;
            display: flex;
            gap: 0.5rem;
        }
        .card-action-btn {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            width: 36px; height: 36px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s ease, transform 0.2s ease;
            backdrop-filter: blur(5px);
        }
        .card-action-btn:hover { background: rgba(0, 0, 0, 0.5); transform: scale(1.1); }
        /* "‡§µ‡§æ‡§ö‡§≤‡•á" ‡§¨‡§ü‡§£ (Item 13) */
        .read-toggle.read {
            background: var(--highlight-color);
            color: #111;
        }

        /* --- ‡§µ‡•ç‡§π‡•ç‡§Ø‡•Ç ‡§ü‡•â‡§ó‡§≤ CSS (Item 2 - ‡•≤‡§®‡§ø‡§Æ‡•á‡§∂‡§®‡§∏‡§æ‡§†‡•Ä) --- */
        .category-list {
            transition: grid-template-columns 0.4s ease; /* ‡•≤‡§®‡§ø‡§Æ‡•á‡§∂‡§® */
        }
        
        /* ‡§µ‡•ç‡§π‡•ç‡§Ø‡•Ç 1: ‡§ó‡•ç‡§∞‡§ø‡§° (Grid) */
        .category-list.view-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }
        .category-list.view-grid li { margin-bottom: 0; }

        /* ‡§µ‡•ç‡§π‡•ç‡§Ø‡•Ç 2: ‡§≤‡§ø‡§∏‡•ç‡§ü (List) */
        .category-list.view-list {
            display: flex; flex-direction: column; gap: 1rem;
        }
        .category-list.view-list li { width: 100%; margin-bottom: 0; }

        /* ‡§µ‡•ç‡§π‡•ç‡§Ø‡•Ç 3: ‡§∞‡•ã (Row / Horizontal) - Item 14 ‡§∏‡§æ‡§†‡•Ä ‡§µ‡§æ‡§™‡§∞‡•Ç */
        .category-list.view-horizontal {
            display: flex; overflow-x: auto; white-space: nowrap;
            gap: 1.5rem; padding: 0.5rem 0.25rem 1.5rem 0.25rem;
            -ms-overflow-style: none; scrollbar-width: none;
        }
        .category-list.view-horizontal::-webkit-scrollbar { display: none; }
        .category-list.view-horizontal li {
            width: 280px; flex-shrink: 0;
            display: inline-block; margin-bottom: 0;
        }
        /* "‡§Ö‡§≤‡•Ä‡§ï‡§°‡•á ‡§™‡§æ‡§π‡§ø‡§≤‡•á‡§≤‡•á" ‡§∏‡§æ‡§†‡•Ä ‡§•‡•ã‡§°‡•á ‡§≤‡§π‡§æ‡§® ‡§ï‡§æ‡§∞‡•ç‡§°‡•ç‡§∏ */
        #recently-viewed-list li {
            min-height: 120px;
            width: 250px;
        }
         #recently-viewed-list h2 { font-size: 1.2rem; }

        /* --- 9. ‡§´‡•Å‡§≤-‡§∏‡•ç‡§ï‡•ç‡§∞‡•Ä‡§® Modal --- */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(var(--blur-amount));
            -webkit-backdrop-filter: blur(var(--blur-amount));
            display: none; align-items: center; justify-content: center; z-index: 1000;
            opacity: 0; transition: opacity 0.3s ease;
        }
        .modal-overlay.active { display: flex; opacity: 1; }
        .modal-overlay iframe {
            width: 95vw; height: 95vh;
            border: 1px solid var(--glass-border-light);
            border-radius: 10px; background: #fff;
            transform: scale(0.95);
            opacity: 0;
            transition: transform 0.3s ease, opacity 0.3s ease;
        }
        .modal-overlay.active iframe {
            transform: scale(1);
            opacity: 1;
        }
        .close-button {
            position: absolute; top: 20px; right: 30px; font-size: 2.5rem;
            font-weight: bold; color: white; background: transparent;
            border: none; cursor: pointer; z-index: 1001;
            text-shadow: 0 1px 3px rgba(0,0,0,0.7);
            transition: transform 0.2s ease;
        }
        .close-button:hover { transform: scale(1.1); }

        /* --- 10. ‡§®‡§µ‡•Ä‡§®: ‡§ï‡§Æ‡§æ‡§Ç‡§° ‡§™‡•Ö‡§≤‡•á‡§ü (Item 8) --- */
        #command-palette-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(var(--blur-amount));
            -webkit-backdrop-filter: blur(var(--blur-amount));
            z-index: 2000;
            display: none;
            opacity: 0;
            transition: opacity 0.2s ease-in-out;
        }
        #command-palette-overlay.active {
            display: block;
            opacity: 1;
        }
        #command-palette {
            position: absolute;
            top: 20vh;
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            max-width: 500px;
            background: var(--glass-bg-dark);
            border: 1px solid var(--glass-border-dark);
            border-radius: 12px;
            box-shadow: 0 10px 50px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            transition: transform 0.2s ease-out;
        }
        #command-palette-overlay.active #command-palette {
            transform: translateX(-50%) scale(1);
        }
        #cmd-input {
            width: 100%;
            padding: 1rem;
            font-size: 1.1rem;
            background: transparent;
            border: none;
            border-bottom: 1px solid var(--glass-border-dark);
            color: var(--text-color);
            outline: none;
        }
        #cmd-results {
            list-style: none;
            max-height: 300px;
            overflow-y: auto;
        }
        #cmd-results li {
            padding: 0.75rem 1rem;
            cursor: pointer;
            text-align: left;
            border-bottom: 1px solid var(--glass-border-dark);
            transition: background 0.2s ease;
        }
        #cmd-results li:last-child { border-bottom: none; }
        #cmd-results li:hover, #cmd-results li.selected {
            background: rgba(255, 255, 255, 0.1);
        }
        #cmd-results li small {
            opacity: 0.7;
            margin-left: 0.5rem;
            font-size: 0.8rem;
        }
    </style>
</head>
<body data-theme="dark">
    
    <div class="container">
        <header>
            <div class="theme-switch-wrapper">
                <label class="theme-switch" for="theme-toggle">
                    <input type="checkbox" id="theme-toggle">
                    <span class="slider"></span>
                </label>
            </div>
            <h1>‡§¨‡•ç‡§∞‡§π‡•ç‡§Æ‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ ‡§ï‡§≤‡•ç‡§™‡§¶‡•ç‡§∞‡•Ç‡§Æ</h1>
            
            <p class="subtitle glass-ui">
                ‡§∂‡•ç‡§∞‡•Ä‡§ï‡•É‡§∑‡•ç‡§£‡§∞‡§æ‡§µ‡•ã ‡§Æ‡•ç‡§π‡§£‡•á ‡§â‡§¶‡•ç‡§ß‡§µ‡§¶‡•á‡§µ‡§æ : ‡§π‡§æ ‡§ú‡•ç‡§û‡§æ‡§®‡§∞‡§§‡•ç‡§®‡§æ‡§ö‡§æ ‡§†‡•á‡§µ‡§æ :<br>
                ‡§≠‡§≤‡•á‡§§‡§Ø‡§æ ‡§π‡§æ‡§§‡•Ä‡§Ç ‡§®‡•á‡§¶‡§æ‡§µ‡§æ : ‡§Ö‡§ß‡§ø‡§ï‡§æ‡§∞‡•á‡§Ç‡§µ‡•Ä‡§£ ‡•§‡•§<br>
                ‡§π‡•á ‡§ú‡•ç‡§û‡§æ‡§®‡§∏‡•Å‡§ß‡§æ ‡§ó‡•ã‡§Æ‡§ü‡•Ä : ‡§ú‡•á ‡§™‡§æ‡§® ‡§ï‡§∞‡•Ä‡§§‡§ø ‡§ï‡§∞‡•ç‡§£‡§™‡•Å‡§ü‡•Ä‡§Ç : <br>
                ‡§§‡§Ø‡§æ‡§Ç ‡§ï‡§π‡§ø‡§Ç ‡§®‡§æ‡§π‡§ø‡§Ç ‡§ï‡§æ‡§Æ‡§æ‡§†‡•Ä : ‡§ú‡§®‡•ç‡§Æ‡§Æ‡§∞‡§£‡§æ‡§ö‡•Ä ‡•§‡•§(‡§∂‡•ç‡§∞‡•Ä‡§â‡§¶‡•ç‡§ß‡§µ‡§ó‡•Ä‡§§‡§æ)<br>
            </p>
        </header>

        <main>
            
            <div class="view-toggle glass-ui">
                <button id="view-grid" class="active" title="Grid View">&#9638;</button>
                <button id="view-list" title="List View">&#9776;</button>
                <button id="view-horizontal" title="Row View">&#8596;</button>
            </div>

            <div class="search-wrapper">
                <input type="search" id="search-bar" class="glass-ui" placeholder="‡§™‡•ç‡§∞‡•ã‡§ú‡•á‡§ï‡•ç‡§ü ‡§∂‡•ã‡§ß‡§æ... (‡§ï‡§ø‡§Ç‡§µ‡§æ 'theme light')">
                <span class="cmd-tip">Cmd+K</span>
            </div>
            
            <div class="categories-container">
                
                <section class="category-section" id="recently-viewed-section" style="display: none;">
                    <h2 class="category-title glass-ui">‡§Ö‡§≤‡•Ä‡§ï‡§°‡•á ‡§™‡§æ‡§π‡§ø‡§≤‡•á‡§≤‡•á</h2>
                    <ul class="category-list view-horizontal" id="recently-viewed-list">
                        </ul>
                </section>

                <section class="category-section">
                    <h2 class="category-title glass-ui">Spiritual Applications</h2>
                    <ul class="category-list view-grid" id="project-list">
                        </ul>
                </section>
                
            </div>
        </main>
    </div>

    <div class="modal-overlay" id="modalOverlay" role="dialog" aria-modal="true">
        <button class="close-button" id="closeModal" aria-label="Close modal">&times;</button>
        <iframe id="projectFrame" src="" frameborder="0" allowfullscreen></iframe>
    </div>

    <div id="command-palette-overlay">
        <div id="command-palette" role="dialog">
            <input type="text" id="cmd-input" placeholder="‡§ï‡§Æ‡§æ‡§Ç‡§° ‡§ü‡§æ‡§à‡§™ ‡§ï‡§∞‡§æ... (‡§â‡§¶‡§æ. 'open gita')">
            <ul id="cmd-results"></ul>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // --- 0. ‡§ó‡•ç‡§≤‡•ã‡§¨‡§≤ ‡§µ‡•ç‡§π‡•á‡§∞‡§ø‡§è‡§¨‡§≤‡•ç‡§∏ ---
            let allProjects = []; // JSON ‡§Æ‡§ß‡•Ç‡§® ‡§Ü‡§≤‡•á‡§≤‡•á ‡§∏‡§∞‡•ç‡§µ ‡§™‡•ç‡§∞‡•ã‡§ú‡•á‡§ï‡•ç‡§ü‡•ç‡§∏
            let fuse; // Fuzzy Search ‡§∏‡§æ‡§†‡•Ä
            let readStatus = {}; // ‡§µ‡§æ‡§ö‡§≤‡•á‡§≤‡•á ‡§™‡•ç‡§∞‡•ã‡§ú‡•á‡§ï‡•ç‡§ü‡•ç‡§∏ (Item 13)
            let recentlyViewed = []; // (Item 14)

            const dom = {
                projectList: document.getElementById('project-list'),
                searchBar: document.getElementById('search-bar'),
                themeToggle: document.getElementById('theme-toggle'),
                viewToggleButtons: document.querySelectorAll('.view-toggle button'),
                allCategoryLists: document.querySelectorAll('.category-list:not(#recently-viewed-list)'),
                modal: {
                    overlay: document.getElementById('modalOverlay'),
                    frame: document.getElementById('projectFrame'),
                    closeBtn: document.getElementById('closeModal')
                },
                palette: {
                    overlay: document.getElementById('command-palette-overlay'),
                    input: document.getElementById('cmd-input'),
                    results: document.getElementById('cmd-results')
                },
                recentlyViewed: {
                    section: document.getElementById('recently-viewed-section'),
                    list: document.getElementById('recently-viewed-list')
                }
            };

            // --- 1. PWA (Item 1) - ‡§∏‡§∞‡•ç‡§µ‡•ç‡§π‡§ø‡§∏ ‡§µ‡§∞‡•ç‡§ï‡§∞ ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡§∞ ‡§ï‡§∞‡§£‡•á ---
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('sw.js')
                    .then(registration => console.log('Service Worker Registered:', registration))
                    .catch(error => console.log('Service Worker Registration Failed:', error));
            }
            
            // --- 2. ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§á‡§®‡§ø‡§∂‡§ø‡§è‡§≤‡§æ‡§Ø‡§ù‡•á‡§∂‡§® (JSON ‡§≤‡•ã‡§° ‡§ï‡§∞‡§£‡•á - Item 16) ---
            async function initializeApp() {
                loadPreferences(); // ‡§ú‡•Å‡§®‡•ç‡§Ø‡§æ ‡§™‡§∏‡§Ç‡§§‡•Ä ‡§≤‡•ã‡§° ‡§ï‡§∞‡§£‡•á
                await loadData();
                renderProjectList(allProjects);
                renderRecentlyViewed();
                setupEventListeners();
            }

            // --- 3. ‡§™‡§∏‡§Ç‡§§‡•Ä ‡§≤‡•ã‡§°/‡§∏‡•á‡§µ‡•ç‡§π ‡§ï‡§∞‡§£‡•á (Item 3) ---
            function loadPreferences() {
                // Theme (Item 3)
                const currentTheme = localStorage.getItem('theme') || 'dark';
                const isLight = (currentTheme === 'light');
                document.body.dataset.theme = currentTheme;
                dom.themeToggle.checked = isLight;
                
                // View (Item 3)
                const currentView = localStorage.getItem('view') || 'view-grid';
                applyView(currentView);

                // Read Status (Item 13)
                readStatus = JSON.parse(localStorage.getItem('readStatus')) || {};
                
                // Recently Viewed (Item 14)
                recentlyViewed = JSON.parse(localStorage.getItem('recentlyViewed')) || [];
            }

            // --- 4. JSON ‡§°‡•á‡§ü‡§æ ‡§≤‡•ã‡§° ‡§ï‡§∞‡§£‡•á (Item 16) ---
            async function loadData() {
                try {
                    const response = await fetch('projects.json');
                    allProjects = await response.json();
                    
                    // Fuzzy Search (Item 7) - Fuse.js ‡§∏‡•á‡§ü‡§Ö‡§™
                    const options = {
                        keys: ['title', 'description', 'id'],
                        threshold: 0.4, // 0.0 = perfect match, 1.0 = any match
                    };
                    fuse = new Fuse(allProjects, options);
                    
                } catch (error) {
                    console.error('Error loading projects:', error);
                    dom.projectList.innerHTML = '<li>‡§™‡•ç‡§∞‡•ã‡§ú‡•á‡§ï‡•ç‡§ü‡•ç‡§∏ ‡§≤‡•ã‡§° ‡§ï‡§∞‡§£‡•ç‡§Ø‡§æ‡§§ ‡§Ö‡§Ø‡§∂‡§∏‡•ç‡§µ‡•Ä.</li>';
                }
            }

            // --- 5. ‡§™‡•ç‡§∞‡•ã‡§ú‡•á‡§ï‡•ç‡§ü ‡§ï‡§æ‡§∞‡•ç‡§°‡•ç‡§∏ ‡§∞‡•á‡§Ç‡§°‡§∞ ‡§ï‡§∞‡§£‡•á ---
            function renderProjectList(projects) {
                dom.projectList.innerHTML = ''; // ‡§≤‡§ø‡§∏‡•ç‡§ü ‡§∞‡§ø‡§ï‡§æ‡§Æ‡•Ä ‡§ï‡§∞‡§£‡•á
                projects.forEach(project => {
                    const projectData = project.item || project; // (fuse.js 'item' property ‡§¶‡•á‡§§‡•ã)
                    dom.projectList.appendChild(createProjectCard(projectData));
                });
            }

            function createProjectCard(project) {
                const li = document.createElement('li');
                li.className = 'glass-ui';
                li.dataset.url = project.url;
                li.dataset.id = project.id; // 'id' ‡§µ‡§∞‡•Ç‡§® ‡§ì‡§≥‡§ñ‡§£‡•á
                li.style.backgroundImage = `url('${project.image}')`;
                li.tabIndex = 0; // (Item 17 - Accessibility)

                const isRead = readStatus[project.id]; // (Item 13)

                li.innerHTML = `
                    <div class="card-actions">
                        <button class="card-action-btn share-btn" title="Share">&#10148;</button>
                        <button class="card-action-btn read-toggle ${isRead ? 'read' : ''}" title="Mark as Read">
                            ${isRead ? '&#10003;' : '&#9711;'}
                        </button>
                    </div>
                    <div class="card-content">
                        <h2>${project.title}</h2>
                        <p>${project.description}</p>
                    </div>
                `;

                // --- ‡§ï‡§æ‡§∞‡•ç‡§°‡§∏‡§æ‡§†‡•Ä ‡§á‡§µ‡•ç‡§π‡•á‡§Ç‡§ü ‡§≤‡§ø‡§∏‡•ç‡§ü‡§®‡§∞‡•ç‡§∏ ---
                
                // 1. ‡§ï‡§æ‡§∞‡•ç‡§°‡§µ‡§∞ ‡§ï‡•ç‡§≤‡§ø‡§ï (Modal ‡§â‡§ò‡§°‡§£‡•ç‡§Ø‡§æ‡§∏‡§æ‡§†‡•Ä)
                li.addEventListener('click', (e) => {
                    // ‡§ú‡§∞ ‡§¨‡§ü‡§£‡§æ‡§µ‡§∞ ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ù‡§æ‡§≤‡•á ‡§Ö‡§∏‡•á‡§≤, ‡§§‡§∞ Modal ‡§â‡§ò‡§°‡•Ç ‡§®‡§ï‡§æ
                    if (e.target.closest('.card-action-btn')) return;
                    openModal(project.url, project.id, project.title);
                });

                // 2. ‡§ï‡•Ä‡§¨‡•ã‡§∞‡•ç‡§° 'Enter' (Item 17 - Accessibility)
                li.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' && !e.target.closest('.card-action-btn')) {
                        openModal(project.url, project.id, project.title);
                    }
                });

                // 3. ‡§∂‡•á‡§Ö‡§∞ ‡§¨‡§ü‡§® (Item 15)
                li.querySelector('.share-btn').addEventListener('click', (e) => {
                    e.stopPropagation(); // ‡§ï‡§æ‡§∞‡•ç‡§° ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ü‡•ç‡§∞‡§ø‡§ó‡§∞ ‡§π‡•ã‡§ä ‡§®‡§Ø‡•á
                    shareProject(project.title, project.url);
                });

                // 4. '‡§µ‡§æ‡§ö‡§≤‡•á' ‡§¨‡§ü‡§® (Item 13)
                li.querySelector('.read-toggle').addEventListener('click', (e) => {
                    e.stopPropagation();
                    toggleReadStatus(project.id, e.currentTarget);
                });

                return li;
            }

            // --- 6. ‡§∏‡§∞‡•ç‡§µ ‡§á‡§µ‡•ç‡§π‡•á‡§Ç‡§ü ‡§≤‡§ø‡§∏‡•ç‡§ü‡§®‡§∞‡•ç‡§∏ ‡§∏‡•á‡§ü‡§Ö‡§™ ---
            function setupEventListeners() {
                // Theme Toggle (Item 3)
                dom.themeToggle.addEventListener('change', () => {
                    const newTheme = dom.themeToggle.checked ? 'light' : 'dark';
                    document.body.dataset.theme = newTheme;
                    localStorage.setItem('theme', newTheme);
                });

                // View Toggles (Item 3)
                dom.viewToggleButtons.forEach(button => {
                    button.addEventListener('click', () => {
                        const newViewClass = button.id;
                        applyView(newViewClass);
                        localStorage.setItem('view', newViewClass);
                    });
                });

                // Modal Close (Item 17 - Accessibility)
                dom.modal.closeBtn.addEventListener('click', closeModal);
                dom.modal.overlay.addEventListener('click', (e) => {
                    if (e.target === dom.modal.overlay) closeModal();
                });

                // Keyboard Listeners (Accessibility & Commands)
                document.addEventListener('keydown', (e) => {
                    // Modal 'Esc' (Item 17)
                    if (e.key === 'Escape' && dom.modal.overlay.classList.contains('active')) {
                        closeModal();
                    }
                    // Command Palette 'Esc' (Item 8)
                    if (e.key === 'Escape' && dom.palette.overlay.classList.contains('active')) {
                        closeCommandPalette();
                    }
                    // Command Palette 'Cmd+K' (Item 8)
                    if ((e.metaKey || e.ctrlKey) && e.key === 'k') {
                        e.preventDefault();
                        openCommandPalette();
                    }
                });

                // Search Bar (Item 5 + 7)
                dom.searchBar.addEventListener('input', handleSearchInput);

                // Command Palette (Item 8)
                dom.palette.overlay.addEventListener('click', (e) => {
                    if (e.target === dom.palette.overlay) closeCommandPalette();
                });
                dom.palette.input.addEventListener('input', handleCommandInput);
            }
            
            // --- 7. ‡§µ‡•ç‡§π‡•ç‡§Ø‡•Ç ‡§ü‡•â‡§ó‡§≤ ‡§≤‡•â‡§ú‡§ø‡§ï (Item 3) ---
            function applyView(viewClass) {
                dom.viewToggleButtons.forEach(btn => btn.classList.remove('active'));
                document.getElementById(viewClass)?.classList.add('active');
                dom.allCategoryLists.forEach(list => {
                    list.classList.remove('view-grid', 'view-list', 'view-horizontal');
                    list.classList.add(viewClass);
                });
            }

            // --- 8. Modal ‡§≤‡•â‡§ú‡§ø‡§ï (Item 14 ‡§∏‡§æ‡§†‡•Ä ‡§Ö‡§™‡§°‡•á‡§ü‡•á‡§°) ---
            function openModal(url, id, title) {
                if (url) {
                    dom.modal.frame.src = url;
                    dom.modal.overlay.classList.add('active');
                    // ‡§Ö‡§≤‡•Ä‡§ï‡§°‡•á ‡§™‡§æ‡§π‡§ø‡§≤‡•á‡§≤‡•á (Item 14)
                    addToRecentlyViewed(id, title, url);
                }
            }
            function closeModal() {
                dom.modal.overlay.classList.remove('active');
                dom.modal.frame.src = '';
            }

            // --- 9. ‡§∂‡•á‡§Ö‡§∞ ‡§≤‡•â‡§ú‡§ø‡§ï (Item 15) ---
            function shareProject(title, url) {
                if (navigator.share) {
                    navigator.share({
                        title: title,
                        text: `‡§¨‡•ç‡§∞‡§π‡•ç‡§Æ‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ ‡§ï‡§≤‡•ç‡§™‡§¶‡•ç‡§∞‡•Ç‡§Æ ‡§Æ‡§ß‡•Ç‡§® ${title} ‡§™‡§π‡§æ:`,
                        url: url
                    }).catch(error => console.log('Error sharing:', error));
                } else {
                    // Fallback for desktop/unsupported browsers
                    navigator.clipboard.writeText(url);
                    alert('‡§≤‡§ø‡§Ç‡§ï ‡§ï‡•ç‡§≤‡§ø‡§™‡§¨‡•ã‡§∞‡•ç‡§°‡§µ‡§∞ ‡§ï‡•â‡§™‡•Ä ‡§ï‡•á‡§≤‡•Ä ‡§Ü‡§π‡•á!');
                }
            }

            // --- 10. '‡§µ‡§æ‡§ö‡§≤‡•á' ‡§≤‡•â‡§ú‡§ø‡§ï (Item 13) ---
            function toggleReadStatus(id, button) {
                const isNowRead = !readStatus[id];
                readStatus[id] = isNowRead;
                localStorage.setItem('readStatus', JSON.stringify(readStatus));

                // Update button style
                button.classList.toggle('read', isNowRead);
                button.innerHTML = isNowRead ? '&#10003;' : '&#9711;';
                
                // Update main list card (if it exists)
                const mainCardButton = dom.projectList.querySelector(`li[data-id="${id}"] .read-toggle`);
                if (mainCardButton && mainCardButton !== button) {
                    mainCardButton.classList.toggle('read', isNowRead);
                    mainCardButton.innerHTML = isNowRead ? '&#10003;' : '&#9711;';
                }
            }

            // --- 11. ‡§Ö‡§≤‡•Ä‡§ï‡§°‡•á ‡§™‡§æ‡§π‡§ø‡§≤‡•á‡§≤‡•á (Item 14) ---
            function addToRecentlyViewed(id, title, url) {
                // ‡§Ü‡§ß‡•Ä ‡§Ö‡§∏‡•á‡§≤ ‡§§‡§∞ ‡§ï‡§æ‡§¢‡•Ç‡§® ‡§ü‡§æ‡§ï‡§æ
                recentlyViewed = recentlyViewed.filter(item => item.id !== id);
                // ‡§∏‡§∞‡•ç‡§µ‡§æ‡§§ ‡§µ‡§∞ ‡§ç‡§° ‡§ï‡§∞‡§æ
                recentlyViewed.unshift({ id, title, url });
                // ‡§´‡§ï‡•ç‡§§ ‡•´ ‡§†‡•á‡§µ‡§æ
                if (recentlyViewed.length > 5) {
                    recentlyViewed.pop();
                }
                localStorage.setItem('recentlyViewed', JSON.stringify(recentlyViewed));
                renderRecentlyViewed();
            }

            function renderRecentlyViewed() {
                if (recentlyViewed.length === 0) {
                    dom.recentlyViewed.section.style.display = 'none';
                    return;
                }
                
                dom.recentlyViewed.section.style.display = 'block';
                dom.recentlyViewed.list.innerHTML = '';
                
                recentlyViewed.forEach(item => {
                    // ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§™‡•ç‡§∞‡•ã‡§ú‡•á‡§ï‡•ç‡§ü ‡§°‡•á‡§ü‡§æ ‡§Æ‡§ø‡§≥‡§µ‡§æ (image, desc ‡§∏‡§æ‡§†‡•Ä)
                    const fullProject = allProjects.find(p => p.id === item.id);
                    if (fullProject) {
                        dom.recentlyViewed.list.appendChild(createProjectCard(fullProject));
                    }
                });
            }

            // --- 12. ‡§∏‡•ç‡§Æ‡§æ‡§∞‡•ç‡§ü ‡§∏‡§∞‡•ç‡§ö (Item 5) + ‡§´‡§ú‡•Ä ‡§∏‡§∞‡•ç‡§ö (Item 7) ---
            function handleSearchInput(e) {
                const query = e.target.value.toLowerCase().trim();
                
                // ‡§∏‡•ç‡§Æ‡§æ‡§∞‡•ç‡§ü ‡§ï‡§Æ‡§æ‡§Ç‡§° ‡§ö‡•á‡§ï (Item 5)
                if (executeCommand(query)) {
                    dom.searchBar.value = ''; // ‡§ï‡§Æ‡§æ‡§Ç‡§° ‡§ö‡§æ‡§≤‡§≤‡•ç‡§Ø‡§æ‡§∏ ‡§¨‡§æ‡§∞ ‡§∞‡§ø‡§ï‡§æ‡§Æ‡§æ ‡§ï‡§∞‡§æ
                    return;
                }

                // ‡§´‡§ú‡•Ä ‡§∏‡§∞‡•ç‡§ö (Item 7)
                if (query === '') {
                    renderProjectList(allProjects); // ‡§ï‡§æ‡§π‡•Ä ‡§®‡§∏‡•á‡§≤ ‡§§‡§∞ ‡§∏‡§∞‡•ç‡§µ ‡§¶‡§æ‡§ñ‡§µ‡§æ
                } else {
                    const results = fuse.search(query);
                    renderProjectList(results);
                }
            }
            
            // --- 13. ‡§ï‡§Æ‡§æ‡§Ç‡§° ‡§™‡•Ö‡§≤‡•á‡§ü (Item 8) ---
            let commandPaletteActions = [];

            function openCommandPalette() {
                commandPaletteActions = [
                    ...allProjects.map(p => ({
                        name: `Open: ${p.title}`,
                        category: 'Projects',
                        action: () => openModal(p.url, p.id, p.title)
                    })),
                    { name: 'Switch to Light Theme', category: 'Theme', action: () => dom.themeToggle.click() },
                    { name: 'Switch to Dark Theme', category: 'Theme', action: () => dom.themeToggle.click() },
                    { name: 'Set Grid View', category: 'View', action: () => document.getElementById('view-grid').click() },
                    { name: 'Set List View', category: 'View', action: () => document.getElementById('view-list').click() },
                ];
                
                dom.palette.overlay.classList.add('active');
                dom.palette.input.focus();
                renderCommandResults(commandPaletteActions);
            }

            function closeCommandPalette() {
                dom.palette.overlay.classList.remove('active');
                dom.palette.input.value = '';
            }

            function handleCommandInput() {
                const query = dom.palette.input.value.toLowerCase();
                const filteredActions = commandPaletteActions.filter(action => 
                    action.name.toLowerCase().includes(query)
                );
                renderCommandResults(filteredActions);
            }

            function renderCommandResults(actions) {
                dom.palette.results.innerHTML = '';
                actions.forEach(action => {
                    const li = document.createElement('li');
                    li.innerHTML = `${action.name} <small>${action.category}</small>`;
                    li.tabIndex = 0;
                    li.onclick = () => {
                        action.action();
                        closeCommandPalette();
                    };
                    li.onkeydown = (e) => {
                        if (e.key === 'Enter') li.click();
                    };
                    dom.palette.results.appendChild(li);
                });
            }

            // --- 14. ‡§∏‡•ç‡§Æ‡§æ‡§∞‡•ç‡§ü ‡§ï‡§Æ‡§æ‡§Ç‡§° ‡§á‡§Ç‡§ú‡§ø‡§® (Item 5) ---
            // ‡§π‡§æ ‡§∏‡§∞‡•ç‡§ö ‡§¨‡§æ‡§∞ ‡§Ü‡§£‡§ø ‡§ï‡§Æ‡§æ‡§Ç‡§° ‡§™‡•Ö‡§≤‡•á‡§ü ‡§¶‡•ã‡§®‡•ç‡§π‡•Ä‡§∏‡§æ‡§†‡•Ä ‡§µ‡§æ‡§™‡§∞‡§≤‡§æ ‡§ú‡§æ‡§§‡•ã
            function executeCommand(query) {
                query = query.toLowerCase();
                if (query.startsWith('open ')) {
                    const title = query.substring(5).trim();
                    const result = fuse.search(title);
                    if (result.length > 0) {
                        const project = result[0].item;
                        openModal(project.url, project.id, project.title);
                        return true;
                    }
                }
                if (query === 'theme light') {
                    if (!dom.themeToggle.checked) dom.themeToggle.click();
                    return true;
                }
                if (query === 'theme dark') {
                    if (dom.themeToggle.checked) dom.themeToggle.click();
                    return true;
                }
                if (query === 'view grid') {
                    document.getElementById('view-grid').click();
                    return true;
                }
                if (query === 'view list') {
                    document.getElementById('view-list').click();
                    return true;
                }
                return false; // ‡§ï‡•ã‡§£‡§§‡•Ä‡§π‡•Ä ‡§ï‡§Æ‡§æ‡§Ç‡§° ‡§Æ‡•Ö‡§ö ‡§ù‡§æ‡§≤‡•Ä ‡§®‡§æ‡§π‡•Ä
            }

            // --- ‡•≤‡§™ ‡§∏‡•Å‡§∞‡•Ç ‡§ï‡§∞‡§æ ---
            initializeApp();
        });
    </script>
</body>
</html>
